jeffreestarcosmetics.com josephinecosmetics.com hourglasscosmetics.com profusioncosmetics.com
stylishcosmetic.com unearthlycosmetics.com beautycreationscosmetics.com adelnaturalcosmetics.com
frankierosecosmetics.com hnbcosmetics.co.uk theculturecosmetics.com justbcosmetics.co
elfcosmetics.com.au eg-cosmetics.co.uk wcosmetics.com.au katherinecosmetics.com ancientcosmeticz.com
pariahhousecosmetics.com perfumecosmeticsworld.com shinecosmetics.com unsuncosmetics.com
cultcandycosmetics.com kahicosmetics.com duocosmetics.al cosmeticosalpormayor.com sweatcosmetics.com
wortheecosmetics.com glossmecosmetics.com collectioncosmetics.com stackedcosmetics.com
badcompanycosmetics.com geldencosmeticos.com.mx realishcosmetics.com cosmocosmetics.ae
thevegancosmeticsstore.com vanicosmetics.com cheriglowcosmetics.com w7cosmetics.co.uk
melaninpopcosmetics.com createcosmetics.com racosmetics.com usucosmetics.com
taylormadecosmetics.online evpctcosmetics.com privatesocietycosmetics.com
romanticbeautycosmetics.com adeptcosmetics.com cushcosmetics.com therougecosmetics.com
marscosmetics.in smoldercosmetics.com delugecosmetics.com siretcosmetics.com miicosmetics.co.nz
christinachoicosmetics.com sngcosmetics.in popbeautycosmetics.com spoiledcosmetics.com
naturismecosmetics.com undergroundcosmetics.co indigocosmetics.us mecosmetics.com
angeliacosmetics.com attraentecosmetics.com cosmeticsnaturel.fr rgcosmetics.com estatecosmetics.com
renuecosmetics.com tiacosmetics.com ctzncosmetics.com duwopcosmetics.com londonpridecosmetics.com
bombshellcosmeticsllc.com violarougecosmetics.com lashedcosmetics.com sugarlovecosmetics.com
optimanutricosmetics.com.au jeuxlore-cosmetics.de intoxicatedcosmetics.com ubercosmetics.com.au
goicosmetics.com howtomakecosmetics.com heididcosmetics.com byscosmetics.mx laviencosmetics.com
pinkyrosecosmetics.com modcosmetics.in azlicosmetics.fr africacosmetics.com mirecosmetics.com
maryliascottcosmetics.com derol-cosmetics.com luxecosmetics.fr candybarcosmetics.com
oxyglowcosmetics.com forevercosmetics.co.uk loyecosmetics.com gorgeouscosmetics.com.au
thecosmeticline.co.uk merakicosmetics.nl cleocosmetics.com cosmeticsoutletusa.com
pudaiercosmetics.co.uk morecosmetics.dk melodylovecosmetics.com mycakecosmetic.com
stilacosmetics.com catcosmetics.com pabacosmetics.com jmtcosmetics.com royalblackcosmetics.com
evolcosmetics.com geologiecosmetics.com plushcosmetics.com.au wildmintcosmetics.com
keymescosmetics.com justbcosmetics.us glowcosmetics.com.au purcosmetics.co.uk
hippiechiccosmetics.com skcosmetics.me vasanticosmetics.ca contourcosmetics.co.uk
queenfidencecosmetics.com inglotcosmetics.ca browlashcosmetics.com cosmeticpackagingnow.com
senalliscosmetics.com facecasecosmetics.com enovacosmetics.com tharaacosmetics.com litcosmetics.com
miicosmetics.com.au grancosmetics.com 2mcosmetics.ca emmanuelacosmetics.com jordanacosmetics.com
spelacosmetics.com glamazonbeautycosmetics.com lavuucosmetics.com 786cosmetics.com
spunkcosmetics.com mellicosmetics.com dermacosmetics.co.uk lovelightcosmetics.com
donnabellacosmetics.com sauceboxcosmetics.com getboycosmetics.com aneleycosmetics.com
lawsofnaturecosmetics.com bwcosmetica.com stelicosmetics.com glutathionecosmetics.com
promise-cosmetics.co.il cosmetica24.pt desxcosmetics.com verycosmetics.co.uk wink4mecosmetics.com
terremerecosmetics.com myrabcosmetics.com unicorncosmetics.co.uk flekkcosmetics.com vidacosmetic.com
pearlbeautycosmetics.com californiacosmetics.com midnightcosmetics.co omglocosmetics.com
sistarcosmetics.com gasmcosmetics.com lip-synccosmetics.com slybeautycosmetics.com
bebellacosmetics.com claude-cosmetics.de koreancosmeticsww.com alohacosmeticinaturali.it
joshcosmetics.com illuminatelifecosmetics.com blurecosmetics.com elo-cosmetics.com
alinacosmetics.com pribilycosmetics.com tasneemcosmetics.com lashbarbcosmetics.com
veramoorecosmetics.com jennarosecosmetics.com vivluxcosmetics.com colorboxcosmetics.com.gh
oquistcosmetics.com sophiescosmetics.com mattrcosmetics.com londonicosmetics.com natouchcosmetic.com
lusciouscosmetics.pk blushrockcosmetics.com sparkycatcosmetics.com spa-cosmetics.com
kayluxcosmetics.com zoreyacosmetics.com ex1cosmetics.com cosmeticary.com republiccosmetics.com
cailyncosmetics.com saraalicosmetics.com zonjacosmetics.com deepseacosmetics.com
flexbeautycosmetics.com auriccosmetics.com vivecosmetics.com luxecosmetics.de essence-cosmetics.com
arcayacosmetics.com beautycosmeticsca.com cosmeticssquad.com.au mimoncosmetics.com
1111wishfacecosmetics.com eldancosmetics.com.au whitelabelcosmeticsandpackaging.com.au
joacosmetics.com urbanglowcosmetics.org katherinedanielscosmetics.com moitiecosmetics.com
shopcosmeticstreet.com lunacosmetics.co.uk lefruitcosmetics.com ltwcustomcosmetics.com
mizzicosmetics.com dominiquecosmetics.com eventmakerscosmetics.com deadsea-cosmetic.com
sirenxocosmetics.com bloomcosmetics.com givemecosmetics.com beloracosmetics.com vivrecosmetics.com
aacosmeticsus.com iglamcosmetics.com 786cosmetics.co.uk slovacosmetics.com klccosmetics.co.uk
thecosmeticmarket.com solekcosmetics.com annamarticosmetics.com kaynicolecosmetics.com
sheascosmetics.com evxocosmetics.com foufoucosmetics.com delalicosmetics.com catricecosmetics.com
mokacosmetics.com beautypopcosmetics.com eternal-cosmetics.com profusioncosmetics.co.uk
paulinecosmetics.com vgcosmetics.com jessicacosmetics.com ckeycosmetics.com yabycosmetics.com
amazingcosmetics.com myocosmeticcases.com zilchcosmetics.com cosmeticmall.com madlashcosmetics.com
kikicosmetics.ca poppicosmetics.com shadowcosmetics.com mersicosmetics.co.uk
alldolledupcosmetics.com mentedcosmetics.com personacosmetics.co omycosmetics.com
pinkpyramidcosmetics.com kaleidoscosmetics.com philyra-cosmetics.com lafontainecosmetics.com
cocoagecosmetics.com creaturecosmeticlabs.com joannakcosmetics.com klasscosmetics.com
pinkdustcosmetics.com cosmeticoskenos.cl leaderscosmeticsusa.com purelyorganiccosmetics.com
luxecosmetics.ca tropecosmetics.com caracosmetics.com bbroyalcosmetic.com rubymaycosmetics.com
temptresscosmetics.com tsaracosmetics.com jamcosmetics.net juwelcosmetics.com lfactorcosmetics.com
kateblanccosmetics.com ecosmeticworld.com missbricosmetics.com sahelcosmetics.com
chloeferrycosmetics.com foxglowcosmetics.com elacosmetics.com.au kedmacosmetics.com
soloscosmetics.com hollyberrycosmetics.co.uk rocklandcosmetics.com cosmeticdailydeals.com
jeffreestarcosmetics.com.br lepacosmetics.com ihavecosmetics.com nuevolutioncosmetics.com
hh-cosmetics.com cosmeticosdemodaymayoreo.com iman-cosmetics.co.uk shereecosmetics.com
grcosmetics.com alexapersicocosmetics.com carlabeautycosmetics.com emmecosmetics.ca
bmcosmetics.com.au mycosmeticslondon.co.uk gadecosmetics.co.il aromaleighcosmetics.com
glazecosmetics.com chickcosmetics.com nuestratierracosmetica.com transcendcosmetics.org
dadocosmetics.com aphroditecosmetics.com.au luxecosmetics.nl caocosmeticsusa.com
visiblecosmetics.com wickedsisterscosmetics.com storybookcosmetics.com glaminatrixcosmetics.com.au
luxorcosmetics.mx coos-cosmetics.com w7cosmetics.com vasanticosmetics.co.uk hallyucosmetics.com
thecosmeticsfridge.com exocosmetics.com feralcosmetics.com moonplaycosmetics.com
nikkiajoycosmetics.co republiccosmeticsusa.com skinzicosmetics.com lukacosmetics.com
blueskycosmetics.co.uk thedollhousecosmetics.com nadalinacosmetics.com goldcosmeticssupplies.com
cosmeticsonline.ie shroudcosmetics.com savagesbiocosmetics.com goatcosmetics.com
boldbeautycosmetics.co.uk alivercosmetics.com 4evermagiccosmetics.com froyacosmetics.no
blackmooncosmetics.com instacosmetic.com diycosmetics.com bossygirlcosmetics.com syrupcosmetics.com
asteriaphytocosmetics.com cosmeticaid.com addictivecosmetics.co vcosmetic.ca vandalcosmetics.com
siiacosmetics.com 180cosmetics.com chichicosmetics.com teiacosmeticos.com ingacosmetics.com
irresistiblecosmetics.co.za techniccosmetics.com notecosmetics.com.co bababoom-cosmetics.de
sarcasticcosmetics.com laramichellecosmetics.com merodacosmetics.com irabacosmetics.com
smithcosmetics.com foreverbeautycosmetics.net joliicosmetics.com tweakcosmetica.com
bellecicosmetics.com lolacosmetics.com vhcosmetics.sk juice-cosmetics.com matrixlashcosmetics.com
tasneemcosmetics.com.au superskincosmetics.com mannakadarcosmetics.com glamorouschickscosmetics.com
iman-cosmetics.fr www.proluxcosmetics.com thedermacosmetics.com zerocosmetics.co.za
milicosmetics.com vicecosmetics.com.ph purposecosmeticsco.com kblcosmetics.com morazecosmetics.com
emeragecosmetics.com dead-sea-cosmetics-shop.com promise-cosmetics.com icicosmetic.co.uk
flow-cosmetics.nl paesecosmetics.com.mx rgcosmeticspro.com d24kcosmetics.com spektacosmetics.com
fixatecosmetics.com royalcosmetics.net cosmeticsmarts.com proterracosmetics.com nagicosmetics.com
raazikacosmetics.com cosmeticworkshop.eu cosmeticsmadeinusa.com onthewildsidecosmetics.com
duchesscosmetics.com kabcosmetics.com shanycosmetics.com ccolorcosmetics.com sugahmamacosmetics.com
laroccosmetics.co.uk kokiecosmetics.com simplicitycosmetics.com lecharmecosmetics.com
purposecosmetics.co joylorrainecosmetics.com lutececosmetics.com vintagecosmetics.com mccosmetics.mx
habitcosmetics.com loolacosmetics.com nelocosmetics.com luluxcosmetics.com babecosmetics.com
drecosmetics.be vasanticosmetics.com havucosmetics.fi lumierecosmetics.com skonecosmetics.com
clamycosmetics.com cosmeticholic.com shainabcosmetics.com mellowcosmetics.com.au
bovanticosmetics.com sevenandsixcosmetics.com amournoircosmetics.com tp-cosmetics.de
gadecosmetics.com epilynxcosmetics.com disguisecosmetics.com elitekoreancosmetics.com
smdcosmetics.com everglowcosmetics.com lasplashcosmetics.ca elatecosmetics.ca goplaycosmetics.com
mellowcosmetics.com citycolorcosmetics.com plscosmetics.com olecosmetics.com.mx sphinxcosmetics.com
blendbunnycosmetics.com prettydollcosmetics.com ranicosmetics.com caleycosmetics.com valcosmetics.mx
sugarpillcosmetics.com formulazcosmetics.com mynkcosmetics.com medusacosmetics.com
cosmeticsolutions.com poundcakecosmetics.com shifrahcosmetics.com saoicosmetics.com
myntcosmetics.com maverocosmetics.de backstagecosmetics.ca kamicosmetics.com bygeorginacosmetics.com
ediblecosmetics.com.au luxecosmetics.se oyucosmetics.com pdlcosmetics.com rebcosmetics.com.au
slatercosmetics.co.uk tpfcosmetics.com violentkittycosmetics.com allurecosmeticcompany.com
baileerosecosmetics.com blackpurllcosmetics.com boldbeautifulcosmetics.com culturacosmetics.com
envicosmetics.com.au enumcosmetics.com gemineyecosmetics.com glamourgirlscosmetics.com
icreatecosmetics.com.au jasmeecosmetics.com kelvidoviarcosmetics.com keyycosmeticss.com
lingscosmetics.ca lusciousbeautycosmetics.com marencosmetics.com myroyaltycosmetics.com
nnennacosmetics.com oavcosmetics.com orbalcosmetics.com princekiyahcosmetics.com
purebeautycosmetic.com romancolorcosmetics.com sassiecosmetics.com shopbombshellcosmetics.com
soarcosmeticscompany.com soulchiccosmetics.com staminacosmetics.com technakallyprettycosmetics.com
truglowcosmetics.com tsg-cosmetics.com vnrcosmetics.com wanda-cosmetics.com slayreadycosmetics.com
beautycrushcosmetics.com bkbeautycosmetics.com ceecosmetics.com deepbeautycosmetics.com
elleracosmetics.com isabellacosmetics.net rinconcosmetics.com touchoffancycosmetics.com
arttitudecosmetics.co.uk bailascosmetics.com bgbcosmetics.com blushandglowcosmetics.com
coloursplashcosmetics.com cultcosmetica.com.au dollfacecosmetics.uk envydiacosmetics.com
getleighedcosmetics.com jhocosmetics.com kleurecosmetics.com lab2fabcosmetics.com lustercosmetics.in
magiablucosmetics.com makeupexpertscosmetics.com marblcosmetics.com moovcosmetics.com
musemadecosmetics.com nadacosmetics.com naturegirlcosmetics.com newencosmetica.com
notebookcosmetics.com oohlalacosmetics.ca rarebreedcosmetics.com redumbrellacosmetics.com
royalcosmetica.com rulacosmetics.com samleacosmetics.com selenecosmetics.com.au shcosmetics.com
starfirecosmetics.com summercosmeticz.com talcosmetics.com teacupcosmetics.com trettl-cosmetics.com
wagnercosmetics.com wisegirlcosmetics.com yinxcosmetics.com alegicosmetics.com
accordingtomecosmetics.com comiccosmetics.com foxtailcosmetics.com jooscosmetica.com
classycosmeticss.com millykcosmetics.org naturallygorgeouscosmetics.co.uk notecosmetics.ru
novajadecosmetics.com particularcosmetics.com.au rikucosmetics.com standoutcosmetics.com
jobalosacosmetics.com laliancosmetics.com matica-cosmetics.com macbaddcosmetics.com
nimcosmetics.co.uk monescosmetics.com mirrormirrorcosmeticco.com patronascosmetics.com
ag-cosmetics.com beautymecosmetics.com fabulouscosmetics.co facescosmetics.com inxcosmetics.com
lasheticcosmetics.com luneriacosmetics.com ovcosmetics.com hushmoneycosmetics.com
itsgoldcosmetics.com sabinahaircosmetics.com thepowderroomcosmetics.com urbankcosmetics.com
warriorqueencosmetics.com wrcosmetics.net xotiiccosmetics.com btycosmetics.co.uk g4icosmetics.de
inkcosmetics.co.uk kaileecosmetics.com seekyourselfcosmetics.com brittanyscosmetics.com
ccherellecosmetics.com crvstalcosmetics.com vanidosacosmetics.com prettyglosscosmetics.com
786cosmetics.pk eyelovetcosmetics.com anikocosmetics.com bestbeautycosmetics.ca humblecosmetics.com
sinorabeautycosmetics.com shybearcosmetics.com krcosmeticsga.com mariposacosmetics.co.uk
andcosmeticsco.com anamariacosmetics.com cococosmeticsonline.com idolxcosmetics.com
louxcosmetics.com lucelipscosmetics.com pryncesscosmetics.com kdhcosmetic.com cosmeticosenlinea.com
irvettecosmetics.com unicorncosmetics.com olatcosmetics.com etourecosmetics.com
naturell-cosmetics.com 2ndlovecosmetics.com lpcosmetic.com purelycosmetics.com
vanityboxcosmetics.com communitycosmetics.com refinecosmetics.com cosmeticsgiant.com
abiocosmetic.com shademecosmetic.com larissalovecosmetics.com lapurecosmetics.com
makeupbyyoucosmetics.com v-forevercosmetics.com erui-cosmetics.com kinacosmetics.com
josiemarancosmetics.com nikkiajoycosmetics.com tashcosmetics.com danyelcosmetics.com
dollbabecosmetics.com rclocosmetics.com kimbiecosmetics.com tasneemcosmetics.co.uk
unicornqueencosmetics.com boytoycosmetics.com einnafcosmetics.com logixcosmetics.com
runecosmetics.com jazzycosmetics.net shophavencosmetics.com faces-cosmetics.com geldencosmeticos.com
aloeveracosmetics.com.au massipoli-cosmetics.com bbwcosmetics.net dlacosmetics.com crushcosmetics.ca
phoeracosmetics.co.uk kalucosmetics.com mjscosmeticos.com ditocosmetics.com boujettacosmetics.com
lucidhoneycosmetics.com devon-cosmetics.com campuscosmeticsllc.com necromancycosmetica.com
mytubescosmetics.com sabreencosmetics.com mimiccosmetics.com stowawaycosmetics.com eze-cosmetics.com
wingitcosmetics.com kandykisscosmetics.com morgancosmetics.com intensecosmetics.com
evelinecosmeticsusa.com highlifecosmetics.com emcosmetics.com europacosmetica.com.au
belleamecosmetics.com eleganzabeautycosmetics.com mncosmetic.com fabiconcosmetics.com
lolascosmetics.com kaleidocosmetics.com dyosacosmetics.com vampyrecosmetics.com ffcosmetics.com
galenikacosmetics.com staygoldencosmetics.com raldhcosmetics.com leecare-cosmetics.com
mersicosmetics.com myscanaturalcosmetics.com baqecosmetics.com fashiontvcosmetics.com
personacosmetics.com xoxoxocosmetics.com cosmeticpack.com

<template>
  <div class="interactive-map-container">
    <div class="controls">
      <select v-model="selectedState" @change="updateVisualizations">
        <option v-for="state in states" :key="state" :value="state">{{ state }}</option>
      </select>
      <select v-model="selectedMonth" @change="updateVisualizations">
        <option v-for="month in months" :key="month" :value="month">{{ month }}</option>
      </select>
      <select v-model="selectedViz" @change="updateVisualizations">
        <option value="birdPlant">Birds & Plants</option>
        <option value="sankeyDiagram">Sankey Diagram</option>
        <option value="sunburst">Sunburst</option>
        <option value="chordDiagram">Chord Diagram</option>
      </select>
    </div>

    <div class="visualization-container">
      <!-- Map component -->
      <div ref="mapContainer" class="map-view"></div>

      <!-- Visualizations that will be shown/hidden based on selection -->
      <div v-show="selectedViz === 'birdPlant'" class="viz-panel">
        <div ref="birdChart" class="chart"></div>
        <div ref="plantChart" class="chart"></div>
      </div>

      <div v-show="selectedViz === 'sankeyDiagram'" class="viz-panel">
        <div ref="sankeyChart" class="chart"></div>
      </div>

      <div v-show="selectedViz === 'sunburst'" class="viz-panel">
        <div ref="sunburstChart" class="chart"></div>
      </div>

      <div v-show="selectedViz === 'chordDiagram'" class="viz-panel">
        <div ref="chordChart" class="chart"></div>
      </div>
    </div>
  </div>
</template>

<script>
// Import necessary visualization libraries
import * as d3 from 'd3'
import * as echarts from 'echarts'
import { sankeyLinkHorizontal } from 'd3-sankey'

export default {
  name: 'InteractiveMap',
  data() {
    return {
      // Selection state
      selectedState: 'QLD',
      selectedMonth: 'February',
      selectedViz: 'birdPlant',

      // Data
      birdData: [],
      plantData: [],
      sankeyData: {},
      sunburstData: {},
      chordData: {},

      // Chart instances
      birdChart: null,
      plantChart: null,
      sankeyChart: null,
      sunburstChart: null,
      chordChart: null,

      // Options
      states: ['QLD', 'NSW', 'VIC', 'SA', 'WA'],
      months: [
        'January',
        'February',
        'March',
        'April',
        'May',
        'June',
        'July',
        'August',
        'September',
        'October',
        'November',
        'December',
      ],
    }
  },

  mounted() {
    this.loadData()
    this.initMap()
  },

  methods: {
    // Load data from API or static JSON file
    async loadData() {
      try {
        const response = await fetch('/api/australia-birds-plants')
        const data = await response.json()
        this.processData(data)
        this.updateVisualizations()
      } catch (error) {
        console.error('Error loading data:', error)
      }
    },

    // Process raw data into formats needed for different visualizations
    processData(data) {
      // Process bird data
      this.processBirdData(data)

      // Process plant data
      this.processPlantData(data)

      // Process Sankey data
      this.processSankeyData(data)

      // Process Sunburst data
      this.processSunburstData(data)

      // Process Chord data
      this.processChordData(data)
    },

    processBirdData(data) {
      // Group by bird species and count observations
      const birdCounts = {}

      data.forEach((item) => {
        if (item.state === this.selectedState && item.month === this.selectedMonth) {
          birdCounts[item.species_common_name] =
            (birdCounts[item.species_common_name] || 0) + item.observation_count
        }
      })

      // Convert to array and sort
      this.birdData = Object.entries(birdCounts)
        .map(([name, count]) => ({ name, count }))
        .sort((a, b) => b.count - a.count)
        .slice(0, 10) // Top 10
    },

    processPlantData(data) {
      // Similar to bird data processing
      const plantCounts = {}

      data.forEach((item) => {
        if (item.state === this.selectedState && item.month === this.selectedMonth) {
          plantCounts[item.plant_common_name] =
            (plantCounts[item.plant_common_name] || 0) + item.observation_count
        }
      })

      this.plantData = Object.entries(plantCounts)
        .map(([name, count]) => ({ name, count }))
        .sort((a, b) => b.count - a.count)
        .slice(0, 10)
    },

    processSankeyData(data) {
      // Process data for Sankey diagram (birds -> plants)
      const filteredData = data.filter(
        (item) => item.state === this.selectedState && item.month === this.selectedMonth,
      )

      // Group by bird and plant
      const connections = {}
      filteredData.forEach((item) => {
        const key = `${item.species_common_name}-${item.plant_common_name}`
        connections[key] = (connections[key] || 0) + item.observation_count
      })

      // Create nodes and links
      const nodes = []
      const nodeMap = {}
      const links = []

      // Add bird nodes
      const uniqueBirds = [...new Set(filteredData.map((item) => item.species_common_name))]
      uniqueBirds.forEach((name, index) => {
        nodes.push({ name: `Bird: ${name}` })
        nodeMap[name] = index
      })

      // Add plant nodes
      const uniquePlants = [...new Set(filteredData.map((item) => item.plant_common_name))]
      uniquePlants.forEach((name, index) => {
        nodes.push({ name: `Plant: ${name}` })
        nodeMap[name] = index + uniqueBirds.length
      })

      // Create links
      Object.entries(connections).forEach(([key, value]) => {
        const [bird, plant] = key.split('-')
        links.push({
          source: nodeMap[bird],
          target: nodeMap[plant],
          value: value,
        })
      })

      this.sankeyData = { nodes, links }
    },

    processSunburstData(data) {
      // Process data for sunburst diagram (state > bird > plant)
      const filteredData = data.filter((item) => item.state === this.selectedState)

      // Create hierarchical structure
      const root = {
        name: this.selectedState,
        children: [],
      }

      // Group by bird
      const birdGroups = {}
      filteredData.forEach((item) => {
        if (!birdGroups[item.species_common_name]) {
          birdGroups[item.species_common_name] = {
            name: item.species_common_name,
            children: [],
            value: 0,
          }
        }

        // Check if plant already exists for this bird
        let plantNode = birdGroups[item.species_common_name].children.find(
          (child) => child.name === item.plant_common_name,
        )

        if (!plantNode) {
          plantNode = {
            name: item.plant_common_name,
            value: 0,
          }
          birdGroups[item.species_common_name].children.push(plantNode)
        }

        // Add observation count
        plantNode.value += item.observation_count
        birdGroups[item.species_common_name].value += item.observation_count
      })

      // Add bird groups to root
      root.children = Object.values(birdGroups)

      this.sunburstData = root
    },

    processChordData(data) {
      // Process data for chord diagram
      const filteredData = data.filter(
        (item) => item.state === this.selectedState && item.month === this.selectedMonth,
      )

      // Get unique birds and plants
      const birds = [...new Set(filteredData.map((item) => item.species_common_name))]
      const plants = [...new Set(filteredData.map((item) => item.plant_common_name))]

      // Create matrix
      const matrix = []
      const names = [...birds, ...plants]

      // Initialize matrix with zeros
      for (let i = 0; i < names.length; i++) {
        matrix[i] = Array(names.length).fill(0)
      }

      // Fill matrix with connections
      filteredData.forEach((item) => {
        const birdIndex = birds.indexOf(item.species_common_name)
        const plantIndex = plants.indexOf(item.plant_common_name) + birds.length

        // Bidirectional connections for chord diagram
        matrix[birdIndex][plantIndex] += item.observation_count
        matrix[plantIndex][birdIndex] += item.observation_count
      })

      this.chordData = {
        names,
        matrix,
        birds,
        plants,
      }
    },

    // Initialize map view
    initMap() {
      // Implement map view using leaflet, mapbox, or other mapping library
      // This is a placeholder - you would integrate with your mapping solution
      // For example with Leaflet:
      //
      // this.map = L.map(this.mapContainer).setView([-25.2744, 133.7751], 4);
      // L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(this.map);
    },

    // Update all visualizations based on current selections
    updateVisualizations() {
      this.updateBirdChart()
      this.updatePlantChart()
      this.updateSankeyChart()
      this.updateSunburstChart()
      this.updateChordChart()
    },

    updateBirdChart() {
      // Use D3 or other library to create/update bird chart
      const container = this.$refs.birdChart
      if (!container) return

      // Clear previous chart
      d3.select(container).selectAll('*').remove()

      // Set dimensions
      const margin = { top: 20, right: 30, bottom: 40, left: 90 }
      const width = container.clientWidth - margin.left - margin.right
      const height = container.clientHeight - margin.top - margin.bottom

      // Create SVG
      const svg = d3
        .select(container)
        .append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`)

      // X axis
      const x = d3
        .scaleLinear()
        .domain([0, d3.max(this.birdData, (d) => d.count)])
        .range([0, width])

      svg.append('g').attr('transform', `translate(0,${height})`).call(d3.axisBottom(x))

      // Y axis
      const y = d3
        .scaleBand()
        .domain(this.birdData.map((d) => d.name))
        .range([0, height])
        .padding(0.1)

      svg.append('g').call(d3.axisLeft(y))

      // Bars
      svg
        .selectAll('rect')
        .data(this.birdData)
        .enter()
        .append('rect')
        .attr('y', (d) => y(d.name))
        .attr('height', y.bandwidth())
        .attr('x', 0)
        .attr('width', (d) => x(d.count))
        .attr('fill', '#69b3a2')

      // Title
      svg
        .append('text')
        .attr('x', width / 2)
        .attr('y', -margin.top / 2)
        .attr('text-anchor', 'middle')
        .text(`Bird Observations - ${this.selectedState}, ${this.selectedMonth}`)
    },

    updatePlantChart() {
      // Similar to bird chart but for plants
      const container = this.$refs.plantChart
      if (!container) return

      // Implementation similar to bird chart
      // ...
    },

    updateSankeyChart() {
      // Implement Sankey diagram using D3's Sankey plugin
      if (this.selectedViz !== 'sankeyDiagram') return

      const container = this.$refs.sankeyChart
      if (!container) return

      // Clear previous chart
      d3.select(container).selectAll('*').remove()

      // Create Sankey diagram
      // ...
    },

    updateSunburstChart() {
      // Implement Sunburst chart using D3 or ECharts
      if (this.selectedViz !== 'sunburst') return

      const container = this.$refs.sunburstChart
      if (!container) return

      // Implementation
      // ...
    },

    updateChordChart() {
      // Implement Chord diagram using D3
      if (this.selectedViz !== 'chordDiagram') return

      const container = this.$refs.chordChart
      if (!container) return

      // Implementation
      // ...
    },
  },
}
</script>

<style scoped>
.interactive-map-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
}

.controls {
  display: flex;
  gap: 1rem;
  padding: 1rem;
  background-color: #f5f5f5;
  border-bottom: 1px solid #ddd;
}

.visualization-container {
  display: flex;
  flex: 1;
}

.map-view {
  flex: 1;
  min-width: 50%;
  height: 100%;
}

.viz-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 1rem;
  background-color: white;
}

.chart {
  flex: 1;
  min-height: 300px;
  margin-bottom: 1rem;
}
</style>
